<Project>
  <PropertyGroup>
    <PublishWithAspNetCoreTargetManifest Condition="'$(PublishWithAspNetCoreTargetManifest)'=='' and '$(RuntimeIdentifier)'=='' and '$(RuntimeIdentifiers)'=='' and '$(PublishableProject)'=='true'">true</PublishWithAspNetCoreTargetManifest>
  </PropertyGroup>

  <PropertyGroup Condition="'$(PublishWithAspNetCoreTargetManifest)'=='true'">
    <TargetManifestFiles>$(TargetManifestFiles);$(MSBuildThisFileDirectory)aspnetcore-store-__MANIFEST_VERSION__-win7-x64.xml;$(MSBuildThisFileDirectory)aspnetcore-store-__MANIFEST_VERSION__-win7-x86.xml;$(MSBuildThisFileDirectory)aspnetcore-store-__MANIFEST_VERSION__-osx-x64.xml;$(MSBuildThisFileDirectory)aspnetcore-store-__MANIFEST_VERSION__-linux-x64.xml</TargetManifestFiles>
  </PropertyGroup>

<!--
******************************************************************************
Target: PublishWithAspNetCoreTargetManifest
Error if PublishWithAspNetCoreTargetManifest is set to true for standalone app
******************************************************************************
-->
  <Target
    Name="PublishWithAspNetCoreTargetManifest"
    BeforeTargets="Publish"
    DependsOnTargets="PrepareForPublish"
    Condition="'$(PublishWithAspNetCoreTargetManifest)'=='true'" >

    <Error
      Text="PublishWithAspNetCoreTargetManifest cannot be set to true for standalone apps."
      Condition="'$(RuntimeIdentifier)'!='' or '$(RuntimeIdentifiers)'!=''" />
  </Target>
</Project>
